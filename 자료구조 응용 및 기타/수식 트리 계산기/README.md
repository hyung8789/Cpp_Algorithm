# 수식 트리 계산기 (Postfix Expression-Expression Tree Calculator)

## < 중위 표현식 혹은 후위 표현식 (Infix Expression, Postfix Expression) 으로부터 토큰 생성 >

> '.'을 포함하는 실수의 경우 '.'과 피연산자를 포함한 실수를 하나의 피연산자 토큰으로 처리

	< '.'을 포함하는 실수의 조건 >

	1) '.'은 '.'을 포함하는 실수에서 맨 처음에 단독으로 존재 할 수 없으며, 어떠한 피연산자가 최소 한 번은 존재 한 다음에만 존재
	
	2) '.'은 '.'을 포함하는 실수에서 반드시 한 번만 존재
	
	3) '.'을 포함하는 실수에서 '.'이 존재한 뒤, 피연산자가 최소 한 번은 반드시 존재하여야 하고,
	최소 한 번 이상의 피연산자가 존재 후 더 이상 피연산자가 존재하지 않을 경우,
	이 전체를 하나의 실수로 간주하여 '.' 및 피연산자를 포함 한 하나의 피연산자 토큰으로 처리
	
	---

	1) 대상 표현식에 대해 다 읽거나, 현재까지 읽은 문자에 대해 처리를 위하여 읽기 중지가 발생하는 시점까지 반복

	2) 현재 읽은 문자의 기호 타입에 따라,

		2-1) 현재 읽은 문자의 기호 타입이 피연산자인 경우
			2-1-1) 현재 문자의 다음 문자가 존재하며, 현재 문자의 다음 문자의 기호 타입이 피연산자, 실수 표현을 위한 '.'인 경우
			: 계속 읽기

			2-1-2) 현재 문자의 다음 문자가 존재하며, 현재 문자의 다음 문자의 기호 타입이 피연산자, 실수 표현을 위한 '.'이 아닐 경우
			: 현재까지 읽은 문자에 대해 처리를 위하여 읽기 중지 (오른쪽에서 왼쪽으로 읽었을 경우, 현재까지 읽은 문자 좌우반전)

		2-2) 현재 읽은 문자의 기호 타입이 실수 표현을 위한 '.'인 경우 (이미 '.'가 존재하거나, 현재 문자의 이전, 다음 문자가 존재하지 않을 경우 잘못 된 표현식 예외 발생)
			2-2-1) 현재 문자의 이전, 다음 문자가 존재하며, 현재 문자의 이전, 다음 문자가 피연산자이면
			: 계속 읽기

			2-2-2) 현재 문자의 이전, 다음 문자가 존재하지 않거나, 현재 문자의 이전, 다음 문자가 피연산자가 아닐 경우
			: 잘못 된 표현식 예외 발생

		2-3) 현재 읽은 문자의 기호 타입이 ' ' (피연산자 간 구분을 위한 공백), '(', ')', 연산자인 경우
		: 현재 읽은 문자에 대해 처리를 위하여 읽기 중지

## < 후위 표현식으로부터 수식 트리 구축 >

> 후위 표현식 : 중위 표현식으로부터 '(', ')' 및 연산자 우선순위에 따라 변환

> '.'을 포함하는 실수의 경우 '.'과 피연산자를 포함한 실수를 하나의 피연산자 토큰으로 처리하였으므로, 2-2에서 처리

> 피연산자는 잎 노드, 연산자는 초기 루트 노드 혹은 가지 노드

> 올바른 후위 표현식은 항상 오른쪽 끝에 연산자가 존재하며, 해당 연산자는 수식 트리의 루트 노드

> 구축 된 수식 트리를 후위 순회를 통해 계산을 수행 시, 왼쪽부터 계산되므로, 후위 표현식의 오른쪽에서 왼쪽 (역방향)으로 순차적인 토큰 분리 및 수식 트리 구축 과정 간 오른쪽 자식 노드와 왼쪽 자식 노드 순으로 할당

> 후위 표현식에 ' ' (피연산자 간 구분을 위한 공백)이 존재 할 경우, 이는 트리 구축에 이용하지 않으므로, 토큰의 기호 타입이 ' ' (피연산자 간 구분을 위한 공백)가 아닐 때까지 재 생성

    1) 후위 표현식의 오른쪽에서 왼쪽 (역방향)으로 순차적인 토큰 분리 (피연산자 간 구분을 위한 공백, 피연산자, 연산자)

    2) 분리 된 토큰의 기호 타입에 따라,

		2-1) 피연산자인 경우
		: 해당 토큰은 잎 노드가 되며, 현재 노드에 해당 토큰으로 생성

		2-2) 연산자인 경우
		: 해당 토큰은 초기 루트 노드 혹은 가지 노드가 되며, 현재 노드에 해당 토큰으로 생성하고,
		현재 노드의 오른쪽 하위 트리, 왼쪽 하위 트리에 대해 재귀적으로 이동 (1로 이동하여 토큰 재 생성)

		ex)
		- 현재 노드의 다음 두 토큰이 각각 피연산자일 경우, 해당 토큰은 현재 노드의 각각 오른쪽 자식 노드와 왼쪽 자식 노드
		- 현재 노드의 다음 단일 토큰이 다시 연산자인 경우, 해당 토큰은 가지 노드
	
	---
	
	중위 표현식 : 1.0 * 2.0 + (7.0 - 8.0)
	후위 표현식 : 1.0 2.0 * 7.0 8.0 -+

					+
			*				-
		1.0		2.0		7.0		8.0

## < 구축 된 수식 트리로부터 연산 수행 >

    1) 루트 노드에서 시작, 현재 노드의 기호 타입에 따라,

		1-1) 연산자인 경우
		: 현재 노드의 왼쪽 하위 트리 및 오른쪽 하위 트리로 재귀적으로 이동
		각 하위 트리의 연산 결과를 병합하여 루트 노드 (연산자)에서 최종 계산 결과 반환 (후위 순회)
		단, 현재 노드가 연산자인 경우, 왼쪽 하위 트리 혹은 오른쪽 하위 트리가 하나라도 존재하지 않을 경우 잘못 된 수식 트리 예외 발생

		1-2) 피연산자인 경우
		: 현재 노드의 상위 노드로 현재 노드의 값 전달